"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[806],{7517:function(a,t,e){e.d(t,{c:function(){return n}});var r=e(7437),s=e(8188);let n=a=>{let{colors:t,selectedColor:e,onColorChange:n}=a;return(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Цвет"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:Array.from(new Set(t)).map(a=>{let t=(0,s.OA)(a),o=e===a;return(0,r.jsx)("button",{className:"w-8 h-8 rounded-full border-2 transition-all duration-200 hover:scale-110 ".concat(o?"border-gray-800 ring-2 ring-offset-2 ring-gray-300":"border-gray-300 hover:border-gray-400"),style:{backgroundColor:(null==t?void 0:t.value)||"#CCCCCC",borderColor:"Белый"===a?"#E5E7EB":void 0},onClick:()=>n(a),title:a,"aria-label":"Выбрать цвет ".concat(a)},a)})}),e&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Выбран: ",e]})]})}},3241:function(a,t,e){e.d(t,{i:function(){return F}});var r=e(7437),s=e(2265),n=e(1396),o=e.n(n),l=e(1291),i=e(7158),m=e(3505),c=e(7810),f=e(2609),d=e(3023),x=e(9155),u=e(7517),p=e(6036),y=e(8554),h=e(1609);let g=0,v=new Map,b=a=>{if(v.has(a))return;let t=setTimeout(()=>{v.delete(a),z({type:"REMOVE_TOAST",toastId:a})},1e6);v.set(a,t)},w=(a,t)=>{switch(t.type){case"ADD_TOAST":return{...a,toasts:[t.toast,...a.toasts].slice(0,1)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{let{toastId:e}=t;return e?b(e):a.toasts.forEach(a=>{b(a.id)}),{...a,toasts:a.toasts.map(a=>a.id===e||void 0===e?{...a,open:!1}:a)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...a,toasts:[]};return{...a,toasts:a.toasts.filter(a=>a.id!==t.toastId)}}},k=[],j={toasts:[]};function z(a){j=w(j,a),k.forEach(a=>{a(j)})}function N(a){let{...t}=a,e=(g=(g+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>z({type:"DISMISS_TOAST",toastId:e});return z({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:a=>{a||r()}}}),{id:e,dismiss:r,update:a=>z({type:"UPDATE_TOAST",toast:{...a,id:e}})}}var I=e(9311),S=e(1945),C=e(164);function F(a){let{product:t,className:e,children:n}=a,[g,v]=(0,s.useState)(!1),[b,w]=(0,s.useState)(null),[F,A]=(0,s.useState)(null),[E,_]=(0,s.useState)(1),[O,T]=(0,s.useState)(!1),[D,R]=(0,s.useState)(0),[U,M]=(0,s.useState)(null),[L,B]=(0,s.useState)(!1),{addItem:P}=(0,y.j)(),{isFavorite:Z,toggleFavorite:V}=(0,h.r)(),{toast:H}=function(){let[a,t]=s.useState(j);return s.useEffect(()=>(k.push(t),()=>{let a=k.indexOf(t);a>-1&&k.splice(a,1)}),[a]),{...a,toast:N,dismiss:a=>z({type:"DISMISS_TOAST",toastId:a})}}();(0,s.useEffect)(()=>{if(t.variants&&Array.isArray(t.variants)&&t.variants.length>0){let a=t.variants.filter(a=>"COLOR"===a.type),e=t.variants.filter(a=>"SIZE"===a.type);a.length>0&&w(a[0].value),e.length>0&&A(e[0].value)}},[t]),(0,s.useEffect)(()=>{let a=async()=>{if(g&&t._id)try{B(!0),console.log("Fetching complete product data for:",t._id);let a=await C.h.products.getById(t._id);console.log("Complete product data:",a);let e=a;a&&!0===a.success&&a.data&&a.data.product&&(e=a.data.product,console.log("Using nested data.product format")),M(e),R(0)}catch(a){console.error("Error fetching complete product data:",a),M(t)}finally{B(!1)}};a()},[g,t._id]);let q=async()=>{try{await V(Q._id),Z(Q._id)?H({title:"Товар удален из избранного",description:"".concat(Q.name," удален из избранного")}):H({title:"Товар добавлен в избранное",description:"".concat(Q.name," добавлен в избранное")})}catch(a){H({title:"Ошибка",description:"Не удалось добавить товар в избранное",variant:"destructive"})}},G=async a=>{a.preventDefault(),a.stopPropagation(),await q()},Q=U||t,X=Array.from(new Set(Q.variants&&Array.isArray(Q.variants)?Q.variants.filter(a=>"COLOR"===a.type).map(a=>a.value):[])),J=Array.from(new Set(Q.variants&&Array.isArray(Q.variants)?Q.variants.filter(a=>"SIZE"===a.type).map(a=>a.value):[]));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(f.Vq,{open:g,onOpenChange:a=>{a||v(!1)},children:[(0,r.jsx)(f.hg,{asChild:!0,onClick:a=>{a.preventDefault(),a.stopPropagation(),v(!0)},children:n}),(0,r.jsx)(f.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"relative aspect-square overflow-hidden rounded-lg",children:L?(0,r.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-100",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):Q.images&&Q.images.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.w,{src:Q.images[D].url,thumbnailSrc:Q.images[D].thumbnailUrl,alt:Q.images[D].alt||Q.name,className:"w-full h-full object-cover"}),Q.images.length>1&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.z,{variant:"ghost",size:"icon",className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white rounded-full transition-colors z-10",onClick:()=>{Q.images&&!(Q.images.length<=1)&&R(a=>(a-1+Q.images.length)%Q.images.length)},children:(0,r.jsx)(l.Z,{className:"w-4 h-4"})}),(0,r.jsx)(d.z,{variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white rounded-full transition-colors z-10",onClick:()=>{Q.images&&!(Q.images.length<=1)&&R(a=>(a+1)%Q.images.length)},children:(0,r.jsx)(i.Z,{className:"w-4 h-4"})})]})]}):Q.mainImage?(0,r.jsx)(S.w,{src:Q.mainImage,alt:Q.name,className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-100",children:(0,r.jsx)("span",{className:"text-gray-500",children:"Нет изображения"})})}),!L&&Q.images&&Q.images.length>1&&(0,r.jsx)("div",{className:"flex space-x-2 overflow-x-auto py-2",children:Q.images.map((a,t)=>(0,r.jsx)("button",{className:(0,I.cn)("relative w-16 h-16 overflow-hidden rounded border",D===t?"border-primary":"border-gray-200"),onClick:()=>R(t),children:(0,r.jsx)(S.w,{src:a.url,thumbnailSrc:a.thumbnailUrl,alt:a.alt||"".concat(Q.name," ").concat(t+1),className:"w-full h-full object-cover"})},t))})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:Q.name}),(0,r.jsx)("p",{className:"text-gray-600",children:Q.description})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[Q.category&&(0,r.jsx)(x.C,{variant:"secondary",children:Q.category.name}),Q.isBrandNew&&(0,r.jsx)(x.C,{variant:"default",children:"Новинка"}),Q.isOnSale&&(0,r.jsx)(x.C,{variant:"destructive",children:"Распродажа"})]}),(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[new Intl.NumberFormat("ru-RU").format(Q.price)," ₽"]}),X.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Цвет:"}),(0,r.jsx)(u.c,{colors:X,selectedColor:b||void 0,onColorChange:w})]}),J.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Размер:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:J.map(a=>(0,r.jsx)("button",{className:(0,I.cn)("px-3 py-1 border rounded-md text-sm",F===a?"border-primary bg-primary text-primary-foreground":"border-gray-300 hover:border-gray-400"),onClick:()=>A(a),children:a},a))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Количество:"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(d.z,{variant:"outline",size:"icon",onClick:()=>_(Math.max(1,E-1)),disabled:E<=1,children:"-"}),(0,r.jsx)("span",{className:"w-8 text-center",children:E}),(0,r.jsx)(d.z,{variant:"outline",size:"icon",onClick:()=>_(Math.min(Q.stock,E+1)),disabled:E>=Q.stock,children:"+"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["В наличии: ",Q.stock," шт."]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[(0,r.jsxs)(d.z,{onClick:()=>{if(!b&&!F){H({title:"Ошибка",description:"Пожалуйста, выберите цвет или размер",variant:"destructive"});return}if(Q.stock<E){H({title:"Ошибка",description:"Недостаточно товара на складе",variant:"destructive"});return}P(Q,E,F||void 0,b||void 0),H({title:"Товар добавлен в корзину",description:"".concat(Q.name," добавлен в корзину")}),v(!1)},disabled:0===Q.stock,className:"flex-1",children:[(0,r.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Добавить в корзину"]}),(0,r.jsxs)(d.z,{variant:"outline",onClick:G,className:"flex-1",children:[(0,r.jsx)(c.Z,{className:(0,I.cn)("mr-2 h-4 w-4",Z(Q._id)?"fill-red-500 text-red-500":"")}),Z(Q._id)?"Удалить из избранного":"Добавить в избранное"]})]}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)(d.z,{asChild:!0,variant:"ghost",className:"w-full",children:(0,r.jsx)(o(),{href:"/product/".concat(Q.slug),children:"Перейти на страницу товара"})})})]})]})})]}),(0,r.jsx)(p.Q,{isOpen:O,onClose:()=>T(!1),message:"Для добавления товара в избранное необходимо войти в систему"})]})}},7960:function(a,t,e){e.r(t),e.d(t,{AnimationProvider:function(){return d},AnimationStyles:function(){return f},BounceIn:function(){return m},FadeIn:function(){return o},Pulse:function(){return c},ScaleIn:function(){return i},SlideIn:function(){return l}});var r=e(7437),s=e(1787),n=e.n(s);e(2265);let o=a=>{let{children:t,duration:e=300,delay:s=0,className:n=""}=a;return(0,r.jsx)("div",{className:n,style:{animation:"fadeIn ".concat(e,"ms ease-in-out ").concat(s,"ms forwards"),opacity:0},children:t})},l=a=>{let{children:t,direction:e="up",duration:s=300,delay:n=0,className:o=""}=a;return(0,r.jsx)("div",{className:o,style:{animation:"".concat((()=>{switch(e){case"left":return"slideInLeft";case"right":return"slideInRight";case"down":return"slideInDown";default:return"slideInUp"}})()," ").concat(s,"ms ease-out ").concat(n,"ms forwards"),opacity:0},children:t})},i=a=>{let{children:t,duration:e=300,delay:s=0,className:n=""}=a;return(0,r.jsx)("div",{className:n,style:{animation:"scaleIn ".concat(e,"ms ease-out ").concat(s,"ms forwards"),opacity:0},children:t})},m=a=>{let{children:t,duration:e=600,delay:s=0,className:n=""}=a;return(0,r.jsx)("div",{className:n,style:{animation:"bounceIn ".concat(e,"ms ease-out ").concat(s,"ms forwards"),opacity:0},children:t})},c=a=>{let{children:t,duration:e=1e3,infinite:s=!1,className:n=""}=a;return(0,r.jsx)("div",{className:n,style:{animation:"pulse ".concat(e,"ms ease-in-out ").concat(s?"infinite":"forwards")},children:t})},f=()=>(0,r.jsx)(n(),{id:"22e247735b8601bc",children:"@-webkit-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@-webkit-keyframes slideInUp{from{-webkit-transform:translatey(20px);transform:translatey(20px);opacity:0}to{-webkit-transform:translatey(0);transform:translatey(0);opacity:1}}@-moz-keyframes slideInUp{from{-moz-transform:translatey(20px);transform:translatey(20px);opacity:0}to{-moz-transform:translatey(0);transform:translatey(0);opacity:1}}@-o-keyframes slideInUp{from{-o-transform:translatey(20px);transform:translatey(20px);opacity:0}to{-o-transform:translatey(0);transform:translatey(0);opacity:1}}@keyframes slideInUp{from{-webkit-transform:translatey(20px);-moz-transform:translatey(20px);-o-transform:translatey(20px);transform:translatey(20px);opacity:0}to{-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0);opacity:1}}@-webkit-keyframes slideInDown{from{-webkit-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-webkit-transform:translatey(0);transform:translatey(0);opacity:1}}@-moz-keyframes slideInDown{from{-moz-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-moz-transform:translatey(0);transform:translatey(0);opacity:1}}@-o-keyframes slideInDown{from{-o-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-o-transform:translatey(0);transform:translatey(0);opacity:1}}@keyframes slideInDown{from{-webkit-transform:translatey(-20px);-moz-transform:translatey(-20px);-o-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0);opacity:1}}@-webkit-keyframes slideInLeft{from{-webkit-transform:translatex(-20px);transform:translatex(-20px);opacity:0}to{-webkit-transform:translatex(0);transform:translatex(0);opacity:1}}@-moz-keyframes slideInLeft{from{-moz-transform:translatex(-20px);transform:translatex(-20px);opacity:0}to{-moz-transform:translatex(0);transform:translatex(0);opacity:1}}@-o-keyframes slideInLeft{from{-o-transform:translatex(-20px);transform:translatex(-20px);opacity:0}to{-o-transform:translatex(0);transform:translatex(0);opacity:1}}@keyframes slideInLeft{from{-webkit-transform:translatex(-20px);-moz-transform:translatex(-20px);-o-transform:translatex(-20px);transform:translatex(-20px);opacity:0}to{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0);opacity:1}}@-webkit-keyframes slideInRight{from{-webkit-transform:translatex(20px);transform:translatex(20px);opacity:0}to{-webkit-transform:translatex(0);transform:translatex(0);opacity:1}}@-moz-keyframes slideInRight{from{-moz-transform:translatex(20px);transform:translatex(20px);opacity:0}to{-moz-transform:translatex(0);transform:translatex(0);opacity:1}}@-o-keyframes slideInRight{from{-o-transform:translatex(20px);transform:translatex(20px);opacity:0}to{-o-transform:translatex(0);transform:translatex(0);opacity:1}}@keyframes slideInRight{from{-webkit-transform:translatex(20px);-moz-transform:translatex(20px);-o-transform:translatex(20px);transform:translatex(20px);opacity:0}to{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0);opacity:1}}@-webkit-keyframes scaleIn{from{-webkit-transform:scale(.9);transform:scale(.9);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}@-moz-keyframes scaleIn{from{-moz-transform:scale(.9);transform:scale(.9);opacity:0}to{-moz-transform:scale(1);transform:scale(1);opacity:1}}@-o-keyframes scaleIn{from{-o-transform:scale(.9);transform:scale(.9);opacity:0}to{-o-transform:scale(1);transform:scale(1);opacity:1}}@keyframes scaleIn{from{-webkit-transform:scale(.9);-moz-transform:scale(.9);-o-transform:scale(.9);transform:scale(.9);opacity:0}to{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1);opacity:1}}@-webkit-keyframes bounceIn{0%{opacity:0;-webkit-transform:scale(.3);transform:scale(.3)}50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05)}70%{-webkit-transform:scale(.9);transform:scale(.9)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@-moz-keyframes bounceIn{0%{opacity:0;-moz-transform:scale(.3);transform:scale(.3)}50%{opacity:1;-moz-transform:scale(1.05);transform:scale(1.05)}70%{-moz-transform:scale(.9);transform:scale(.9)}100%{opacity:1;-moz-transform:scale(1);transform:scale(1)}}@-o-keyframes bounceIn{0%{opacity:0;-o-transform:scale(.3);transform:scale(.3)}50%{opacity:1;-o-transform:scale(1.05);transform:scale(1.05)}70%{-o-transform:scale(.9);transform:scale(.9)}100%{opacity:1;-o-transform:scale(1);transform:scale(1)}}@keyframes bounceIn{0%{opacity:0;-webkit-transform:scale(.3);-moz-transform:scale(.3);-o-transform:scale(.3);transform:scale(.3)}50%{opacity:1;-webkit-transform:scale(1.05);-moz-transform:scale(1.05);-o-transform:scale(1.05);transform:scale(1.05)}70%{-webkit-transform:scale(.9);-moz-transform:scale(.9);-o-transform:scale(.9);transform:scale(.9)}100%{opacity:1;-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}}@-webkit-keyframes pulse{0%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.05);transform:scale(1.05)}100%{-webkit-transform:scale(1);transform:scale(1)}}@-moz-keyframes pulse{0%{-moz-transform:scale(1);transform:scale(1)}50%{-moz-transform:scale(1.05);transform:scale(1.05)}100%{-moz-transform:scale(1);transform:scale(1)}}@-o-keyframes pulse{0%{-o-transform:scale(1);transform:scale(1)}50%{-o-transform:scale(1.05);transform:scale(1.05)}100%{-o-transform:scale(1);transform:scale(1)}}@keyframes pulse{0%{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.05);-moz-transform:scale(1.05);-o-transform:scale(1.05);transform:scale(1.05)}100%{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}}@-webkit-keyframes shake{0%,100%{-webkit-transform:translatex(0);transform:translatex(0)}10%,30%,50%,70%,90%{-webkit-transform:translatex(-5px);transform:translatex(-5px)}20%,40%,60%,80%{-webkit-transform:translatex(5px);transform:translatex(5px)}}@-moz-keyframes shake{0%,100%{-moz-transform:translatex(0);transform:translatex(0)}10%,30%,50%,70%,90%{-moz-transform:translatex(-5px);transform:translatex(-5px)}20%,40%,60%,80%{-moz-transform:translatex(5px);transform:translatex(5px)}}@-o-keyframes shake{0%,100%{-o-transform:translatex(0);transform:translatex(0)}10%,30%,50%,70%,90%{-o-transform:translatex(-5px);transform:translatex(-5px)}20%,40%,60%,80%{-o-transform:translatex(5px);transform:translatex(5px)}}@keyframes shake{0%,100%{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0)}10%,30%,50%,70%,90%{-webkit-transform:translatex(-5px);-moz-transform:translatex(-5px);-o-transform:translatex(-5px);transform:translatex(-5px)}20%,40%,60%,80%{-webkit-transform:translatex(5px);-moz-transform:translatex(5px);-o-transform:translatex(5px);transform:translatex(5px)}}.shake{-webkit-animation:shake.5s ease-in-out;-moz-animation:shake.5s ease-in-out;-o-animation:shake.5s ease-in-out;animation:shake.5s ease-in-out}@-webkit-keyframes spin{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}.spin{-webkit-animation:spin 1s linear infinite;-moz-animation:spin 1s linear infinite;-o-animation:spin 1s linear infinite;animation:spin 1s linear infinite}"}),d=a=>{let{children:t}=a;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f,{}),t]})}},1945:function(a,t,e){e.d(t,{w:function(){return o}});var r=e(7437),s=e(2265);let n=a=>{let{className:t="",width:e="100%",height:s="100%"}=a;return(0,r.jsx)("div",{className:"animate-pulse bg-gray-200 rounded-lg ".concat(t),style:{width:e,height:s},children:(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-gray-400",children:(0,r.jsx)("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})})})})})},o=a=>{let{src:t,alt:e,thumbnailSrc:o,className:l="",width:i="100%",height:m="100%",onClick:c}=a,[f,d]=(0,s.useState)(!1),[x,u]=(0,s.useState)(!0),[p,y]=(0,s.useState)(!1),[h,g]=(0,s.useState)(!1),v=(0,s.useRef)(null),b=a=>a?a.replace("https://api.dvberry.ru",""):a,w=b(t),k=o?b(o):void 0;(0,s.useEffect)(()=>{let a=new IntersectionObserver(t=>{let[e]=t;e.isIntersecting&&(j(),a.disconnect())},{threshold:.1});return v.current&&a.observe(v.current),()=>{a.disconnect()}},[]);let j=()=>{if(u(!0),y(!1),o&&!h){let a=new Image;a.onload=()=>{d(!0),u(!1),setTimeout(()=>{g(!0)},300)},a.onerror=()=>{y(!0),u(!1)},a.src=k||""}else{let a=new Image;a.onload=()=>{d(!0),u(!1)},a.onerror=()=>{y(!0),u(!1)},a.src=w}};return(0,r.jsxs)("div",{className:"relative overflow-hidden ".concat(l),style:{width:i,height:m},onClick:()=>{c&&c()},children:[x&&(0,r.jsx)(n,{width:i,height:m,className:"absolute inset-0"}),p?(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 rounded-lg",children:(0,r.jsxs)("div",{className:"text-gray-400 text-center",children:[(0,r.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),(0,r.jsx)("p",{className:"text-sm",children:"Ошибка загрузки"})]})}):(0,r.jsx)("img",{ref:v,src:h?w:k||w,alt:e,className:"w-full h-full object-cover transition-opacity duration-300 ".concat(f?"opacity-100":"opacity-0"),style:{width:i,height:m}}),x&&f&&(0,r.jsx)("div",{className:"absolute inset-0 bg-white bg-opacity-50 transition-opacity duration-300 opacity-0"})]})}},9155:function(a,t,e){e.d(t,{C:function(){return l}});var r=e(7437);e(2265);var s=e(9213),n=e(9311);let o=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(a){let{className:t,variant:e,...s}=a;return(0,r.jsx)("div",{className:(0,n.cn)(o({variant:e}),t),...s})}},1609:function(a,t,e){e.d(t,{r:function(){return n}});var r=e(2265),s=e(164);let n=()=>{let[a,t]=(0,r.useState)([]),[e,n]=(0,r.useState)(!0),[o,l]=(0,r.useState)(!1),[i,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let a=async()=>{try{let a=await s.h.auth.getProfile().catch(()=>null);if(l(!!a),a){n(!0);let a=await s.h.favorites.get();t(a.map(a=>a._id))}}catch(a){console.error("Failed to check auth or load favorites:",a)}finally{n(!1)}};a()},[]);let c=t=>a.includes(t),f=async a=>{if(console.log("toggleFavorite called, isLoggedIn:",o),!o){console.log("User not logged in, showing auth modal"),m(!0);return}try{console.log("User is logged in, toggling favorite"),c(a)?(await s.h.favorites.remove(a),t(t=>t.filter(t=>t!==a))):(await s.h.favorites.add(a),t(t=>[...t,a]))}catch(a){throw console.error("Failed to toggle favorite:",a),a}};return{favorites:a,loading:e,isLoggedIn:o,showAuthModal:i,setShowAuthModal:m,isFavorite:c,toggleFavorite:f}}},8188:function(a,t,e){e.d(t,{OA:function(){return s}});let r=[{name:"Черный",value:"#000000"},{name:"Белый",value:"#FFFFFF"},{name:"Красный",value:"#FF0000"},{name:"Синий",value:"#0000FF"},{name:"Зеленый",value:"#008000"},{name:"Желтый",value:"#FFFF00"},{name:"Оранжевый",value:"#FFA500"},{name:"Фиолетовый",value:"#800080"},{name:"Розовый",value:"#FFC0CB"},{name:"Коричневый",value:"#A52A2A"},{name:"Серый",value:"#808080"},{name:"Бежевый",value:"#F5F5DC"},{name:"Бирюзовый",value:"#40E0D0"},{name:"Лавандовый",value:"#E6E6FA"},{name:"Мятный",value:"#98FB98"},{name:"Коралловый",value:"#FF7F50"},{name:"Индиго",value:"#4B0082"},{name:"Золотой",value:"#FFD700"},{name:"Серебряный",value:"#C0C0C0"},{name:"Бордовый",value:"#800000"}],s=a=>r.find(t=>t.name.toLowerCase()===a.toLowerCase())}}]);