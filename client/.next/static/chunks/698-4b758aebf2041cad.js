"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1980:function(e,l,a){a.d(l,{V:function(){return u}});var t=a(7437),s=a(2265),r=a(3023),i=a(7749),n=a(8390),o=a(8094),c=a(2482),d=a(2549);let u=e=>{let{categories:l,products:a,onFilterChange:u,initialCategory:b}=e,[v,g]=(0,s.useState)(!1),[p,f]=(0,s.useState)({priceRange:[0,15e3],selectedCategories:b?[b]:[],selectedFilters:{},selectedCountries:[],sortBy:"popularity"});(0,s.useEffect)(()=>{b&&!p.selectedCategories.includes(b)&&f(e=>({...e,selectedCategories:[b]}))},[b]);let y=1===p.selectedCategories.length?l.find(e=>e._id===p.selectedCategories[0]):null,m=(e=>{switch(e){case"GLASSES":return[{key:"gender",label:"Пол",type:"CHECKBOX",options:[{value:"MALE",label:"Мужской"},{value:"FEMALE",label:"Женский"},{value:"UNISEX",label:"Унисекс"}],isActive:!0},{key:"frameMaterial",label:"Материал оправы",type:"CHECKBOX",options:[{value:"Ацетат",label:"Ацетат"},{value:"Алюминий",label:"Алюминий"},{value:"Углеродное волокно",label:"Углеродное волокно"},{value:"Нейлон",label:"Нейлон"},{value:"Пластмасса",label:"Пластмасса"},{value:"Смола",label:"Смола"},{value:"Резина",label:"Резина"},{value:"Нержавеющая сталь",label:"Нержавеющая сталь"},{value:"Титан",label:"Титан"},{value:"Дерево",label:"Дерево"}],isActive:!0},{key:"frameStyle",label:"Стиль обода оправы",type:"CHECKBOX",options:[{value:"FULL_RIM",label:"Полный обод"},{value:"RIMLESS",label:"Безободковый"},{value:"SEMI_RIMLESS",label:"Полубезободковый"}],isActive:!0},{key:"lensType",label:"Тип объектива",type:"CHECKBOX",options:[{value:"Classic",label:"Classic"},{value:"Flash",label:"Flash"},{value:"Gradient",label:"Gradient"},{value:"Mirrored",label:"Mirrored"},{value:"Polarized",label:"Polarized"},{value:"Standard",label:"Standard"}],isActive:!0},{key:"availability",label:"Наличие",type:"CHECKBOX",options:[{value:"IN_STOCK",label:"Товар в наличии"},{value:"PRE_ORDER",label:"Предзаказ"}],isActive:!0}];case"SHOES":return[{key:"gender",label:"Пол",type:"CHECKBOX",options:[{value:"MALE",label:"Мужская"},{value:"FEMALE",label:"Женская"},{value:"UNISEX",label:"Унисекс"}],isActive:!0},{key:"shoeSizeSystem",label:"Система размеров",type:"SELECT",options:[{value:"RUS",label:"Российский (RUS)"},{value:"EU",label:"Европейский (EU)"},{value:"US",label:"Американский (US)"},{value:"CM",label:"См (Длина стельки)"}],isActive:!0},{key:"upperMaterial",label:"Материал верха",type:"CHECKBOX",options:[{value:"Натуральная кожа",label:"Натуральная кожа"},{value:"Замша",label:"Замша"},{value:"Нубук",label:"Нубук"},{value:"Текстиль/Холст",label:"Текстиль/Холст"},{value:"Сетка (Мэш)",label:"Сетка (Мэш)"},{value:"Искусственная кожа",label:"Искусственная кожа"},{value:"Резина",label:"Резина"},{value:"Комбинированные материалы",label:"Комбинированные материалы"}],isActive:!0},{key:"soleType",label:"Тип подошвы",type:"CHECKBOX",options:[{value:"Плоская",label:"Плоская (для скейтбординга)"},{value:"Амортизирующая",label:"Амортизирующая (для бега)"},{value:"Резиновая",label:"Резиновая (для трейла)"},{value:"Каучуковая",label:"Каучуковая"},{value:"EVA",label:"EVA (легкая)"}],isActive:!0},{key:"brandTechnology",label:"Технологии брендов",type:"CHECKBOX",options:[{value:"Air Max",label:"Nike: Air Max"},{value:"Air Force",label:"Nike: Air Force"},{value:"Dunk",label:"Nike: Dunk"},{value:"Jordan",label:"Nike: Jordan"},{value:"ZoomX",label:"Nike: ZoomX"},{value:"React",label:"Nike: React"},{value:"Flyknit",label:"Nike: Flyknit"},{value:"Boost",label:"Adidas: Boost"},{value:"Ultraboost",label:"Adidas: Ultraboost"},{value:"NMD",label:"Adidas: NMD"},{value:"Yeezy",label:"Adidas: Yeezy"},{value:"4D",label:"Adidas: 4D"},{value:"Primeknit",label:"Adidas: Primeknit"},{value:"Fresh Foam",label:"New Balance: Fresh Foam"},{value:"FuelCell",label:"New Balance: FuelCell"},{value:"GEL",label:"Asics: GEL"},{value:"GORE-TEX",label:"GORE-TEX"},{value:"VIBRAM",label:"VIBRAM"}],isActive:!0},{key:"availability",label:"Наличие",type:"CHECKBOX",options:[{value:"IN_STOCK",label:"Товар в наличии"},{value:"PRE_ORDER",label:"Предзаказ"}],isActive:!0}];case"CLOTHING":return[{key:"gender",label:"Пол",type:"CHECKBOX",options:[{value:"MALE",label:"Мужское"},{value:"FEMALE",label:"Женское"},{value:"UNISEX",label:"Унисекс"}],isActive:!0},{key:"clothingSizeSystem",label:"Система размеров",type:"SELECT",options:[{value:"INT",label:"Международные"},{value:"RUS",label:"Российские"},{value:"US",label:"Американские"}],isActive:!0},{key:"fabric",label:"Материал",type:"CHECKBOX",options:[{value:"Хлопок",label:"Хлопок"},{value:"Полиэстер",label:"Полиэстер"},{value:"Нейлон",label:"Нейлон"},{value:"Шерсть",label:"Шерсть"},{value:"Кашемир",label:"Кашемир"},{value:"Деним",label:"Деним"},{value:"Кожа",label:"Кожа"},{value:"Замша",label:"Замша"},{value:"Флис",label:"Флис"},{value:"Вискоза",label:"Вискоза"},{value:"Лен",label:"Лен"}],isActive:!0},{key:"style",label:"Стиль",type:"CHECKBOX",options:[{value:"Повседневный",label:"Повседневный (Кэжуал)"},{value:"Спортивный",label:"Спортивный (Эйджис)"},{value:"Уличный стиль",label:"Уличный стиль (Стритвир)"},{value:"Официальный",label:"Официальный (Деловой)"},{value:"Винтаж",label:"Винтаж"},{value:"Минимализм",label:"Минимализм"},{value:"Хай-фэшн",label:"Хай-фэшн (Дизайнерский)"}],isActive:!0},{key:"pattern",label:"Рисунок/Принт",type:"CHECKBOX",options:[{value:"Однотонный",label:"Однотонный"},{value:"С логотипом",label:"С логотипом"},{value:"Графический принт",label:"Графический принт"},{value:"Полоска",label:"Полоска"},{value:"Камуфляж",label:"Камуфляж"},{value:"Цветочный принт",label:"Цветочный принт"},{value:"Надписи",label:"Надписи"},{value:"Без принта",label:"Без принта"}],isActive:!0},{key:"availability",label:"Наличие",type:"CHECKBOX",options:[{value:"IN_STOCK",label:"Товар в наличии"},{value:"PRE_ORDER",label:"Предзаказ"}],isActive:!0}];case"ACCESSORIES":return[{key:"gender",label:"Пол",type:"CHECKBOX",options:[{value:"MALE",label:"Мужской"},{value:"FEMALE",label:"Женский"},{value:"UNISEX",label:"Унисекс"}],isActive:!0},{key:"material",label:"Материал",type:"CHECKBOX",options:[{value:"Кожа",label:"Кожа"},{value:"Текстиль",label:"Текстиль"},{value:"Металл",label:"Металл"},{value:"Пластик",label:"Пластик"},{value:"Дерево",label:"Дерево"}],isActive:!0},{key:"style",label:"Стиль",type:"CHECKBOX",options:[{value:"Повседневный",label:"Повседневный"},{value:"Спортивный",label:"Спортивный"},{value:"Официальный",label:"Официальный"},{value:"Винтаж",label:"Винтаж"}],isActive:!0},{key:"availability",label:"Наличие",type:"CHECKBOX",options:[{value:"IN_STOCK",label:"Товар в наличии"},{value:"PRE_ORDER",label:"Предзаказ"}],isActive:!0}];default:return[]}})(null==y?void 0:y.categoryType),h=Array.from(new Set(a.map(e=>e.country).filter(Boolean))).map(e=>({id:e,name:e,count:a.filter(l=>l.country===e).length})),x=l.map(e=>({id:e._id,slug:e.slug,name:e.name,count:a.filter(l=>l.categoryId&&l.categoryId._id===e._id||l.category&&l.category._id===e._id).length}));(0,s.useEffect)(()=>{C()},[p,a]);let C=()=>{let e=a.filter(e=>{let l=e.price>=p.priceRange[0]&&e.price<=p.priceRange[1],a=!0;p.selectedCategories.length>0&&(a=e.categoryId&&e.categoryId._id?p.selectedCategories.includes(e.categoryId._id):!!e.category&&!!e.category._id&&p.selectedCategories.includes(e.category._id));let t=0===p.selectedCountries.length||e.country&&p.selectedCountries.includes(e.country),s=!0;if(Object.keys(p.selectedFilters).length>0&&e.attributes){for(let[l,a]of Object.entries(p.selectedFilters))if(a.length>0){let t=e.attributes[l];Array.isArray(t)?s=s&&a.some(e=>t.includes(e)):"string"==typeof t?s=s&&a.includes(t):"number"==typeof t&&(s=s&&a.includes(t.toString()))}}return l&&a&&t&&s});switch(p.sortBy){case"price-low":e=e.sort((e,l)=>e.price-l.price);break;case"price-high":e=e.sort((e,l)=>l.price-e.price);break;case"rating":e=e.sort((e,l)=>(l.rating||0)-(e.rating||0));break;case"new":e=e.sort((e,l)=>(l.isBrandNew?1:0)-(e.isBrandNew?1:0));break;default:e=e.sort((e,l)=>(l.rating||0)*(l.reviewsCount||0)-(e.rating||0)*(e.reviewsCount||0))}u(p)},N=(e,l)=>{f(a=>({...a,selectedCategories:l?[...a.selectedCategories,e]:a.selectedCategories.filter(l=>l!==e)}))},j=(e,l)=>{f(a=>({...a,selectedCountries:l?[...a.selectedCountries,e]:a.selectedCountries.filter(l=>l!==e)}))},A=(e,l,a)=>{f(t=>{let s=t.selectedFilters[e]||[],r=a?[...s,l]:s.filter(e=>e!==l);return{...t,selectedFilters:{...t.selectedFilters,[e]:r}}})},k=()=>{f({priceRange:[0,15e3],selectedCategories:b?[b]:[],selectedFilters:{},selectedCountries:[],sortBy:"popularity"})},E=e=>new Intl.NumberFormat("ru-RU").format(e)+" ₽",w=e=>{var l,a,s;let r=p.selectedFilters[e.key]||[];switch(e.type){case"SELECT":return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h3",{className:"font-heading text-lg font-semibold mb-4",children:e.label}),(0,t.jsxs)(o.Ph,{value:r[0]||"",onValueChange:l=>A(e.key,l,!!l),children:[(0,t.jsx)(o.i4,{children:(0,t.jsx)(o.ki,{placeholder:"Выберите ".concat(e.label.toLowerCase())})}),(0,t.jsx)(o.Bw,{children:null===(l=e.options)||void 0===l?void 0:l.map(e=>(0,t.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]})]},e.key);case"MULTI_SELECT":case"CHECKBOX":return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h3",{className:"font-heading text-lg font-semibold mb-4",children:e.label}),(0,t.jsx)("div",{className:"space-y-3",children:null===(a=e.options)||void 0===a?void 0:a.map(l=>(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(i.X,{id:"".concat(e.key,"-").concat(l.value),checked:r.includes(l.value),onCheckedChange:a=>A(e.key,l.value,a)}),(0,t.jsxs)("label",{htmlFor:"".concat(e.key,"-").concat(l.value),className:"flex-1 text-sm cursor-pointer",children:[l.label,void 0!==l.count&&(0,t.jsxs)("span",{className:"text-gray-400 ml-1",children:["(",l.count,")"]})]})]},l.value))})]},e.key);case"RANGE":return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-heading text-lg font-semibold mb-4",children:e.label}),(0,t.jsx)(n.i,{value:[r[0]?parseInt(r[0]):e.min||0],onValueChange:l=>A(e.key,l[0].toString(),!0),max:e.max||100,step:1,className:"w-full"}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,t.jsxs)("span",{children:[e.min||0,e.unit]}),(0,t.jsxs)("span",{children:[r[0]||e.min||0,e.unit]}),(0,t.jsxs)("span",{children:[e.max||100,e.unit]})]})]},e.key);case"COLOR":return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h3",{className:"font-heading text-lg font-semibold mb-4",children:e.label}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:null===(s=e.options)||void 0===s?void 0:s.map(l=>(0,t.jsx)("button",{className:"w-8 h-8 rounded-full border-2 ".concat(r.includes(l.value)?"border-primary scale-110":"border-gray-300 hover:border-gray-400"),style:{backgroundColor:l.value},onClick:()=>A(e.key,l.value,!r.includes(l.value)),title:l.label},l.value))})]},e.key);default:return null}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"lg:hidden fixed bottom-4 right-4 z-50",children:(0,t.jsx)(r.z,{onClick:()=>g(!v),className:"rounded-full shadow-lg",size:"lg",children:(0,t.jsx)(c.Z,{className:"w-5 h-5"})})}),(0,t.jsxs)("div",{className:"".concat(v?"fixed inset-0 z-40 bg-white p-6 lg:relative lg:inset-auto lg:z-auto lg:bg-transparent lg:p-0":"hidden"," lg:block w-full lg:w-80 lg:flex-shrink-0"),children:[v&&(0,t.jsxs)("div",{className:"lg:hidden flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"font-heading text-xl font-bold",children:"Фильтры"}),(0,t.jsx)(r.z,{onClick:()=>g(!1),variant:"ghost",size:"icon",children:(0,t.jsx)(d.Z,{className:"w-5 h-5"})})]}),(0,t.jsx)("div",{className:"lg:bg-white lg:rounded-2xl lg:p-6 lg:shadow-sm",children:(0,t.jsx)(()=>(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-heading text-lg font-semibold mb-4",children:"Цена"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(n.i,{value:p.priceRange,onValueChange:e=>f(l=>({...l,priceRange:e})),max:15e3,step:100,className:"w-full"}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,t.jsx)("span",{children:E(p.priceRange[0])}),(0,t.jsx)("span",{children:E(p.priceRange[1])})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-heading text-lg font-semibold mb-4",children:"Категории"}),(0,t.jsx)("div",{className:"space-y-3",children:x.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(i.X,{id:e.id,checked:p.selectedCategories.includes(e.id),onCheckedChange:l=>N(e.id,l)}),(0,t.jsxs)("label",{htmlFor:e.id,className:"flex-1 text-sm cursor-pointer hover:text-primary transition-colors",children:[e.name,(0,t.jsxs)("span",{className:"text-gray-400 ml-1",children:["(",e.count,")"]})]})]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-heading text-lg font-semibold mb-4",children:"Страна производитель"}),(0,t.jsx)("div",{className:"space-y-3",children:h.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(i.X,{id:e.id||"",checked:!!e.id&&p.selectedCountries.includes(e.id),onCheckedChange:l=>e.id&&j(e.id,l)}),(0,t.jsxs)("label",{htmlFor:e.id||"",className:"flex-1 text-sm cursor-pointer",children:[e.name,(0,t.jsxs)("span",{className:"text-gray-400 ml-1",children:["(",e.count,")"]})]})]},e.id))})]}),m.map(w),(0,t.jsx)(r.z,{onClick:k,variant:"outline",className:"w-full",children:"Очистить фильтры"})]}),{})})]})]})}},7749:function(e,l,a){a.d(l,{X:function(){return o}});var t=a(7437),s=a(2265),r=a(6062),i=a(2442),n=a(9311);let o=s.forwardRef((e,l)=>{let{className:a,...s}=e;return(0,t.jsx)(r.fC,{ref:l,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,t.jsx)(r.z$,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})})});o.displayName=r.fC.displayName},8094:function(e,l,a){a.d(l,{Bw:function(){return p},Ph:function(){return d},Ql:function(){return y},i4:function(){return b},ki:function(){return u}});var t=a(7437),s=a(2265),r=a(8973),i=a(3523),n=a(9224),o=a(2442),c=a(9311);let d=r.fC;r.ZA;let u=r.B4,b=s.forwardRef((e,l)=>{let{className:a,children:s,...n}=e;return(0,t.jsxs)(r.xz,{ref:l,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[s,(0,t.jsx)(r.JO,{asChild:!0,children:(0,t.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});b.displayName=r.xz.displayName;let v=s.forwardRef((e,l)=>{let{className:a,...s}=e;return(0,t.jsx)(r.u_,{ref:l,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,t.jsx)(n.Z,{className:"h-4 w-4"})})});v.displayName=r.u_.displayName;let g=s.forwardRef((e,l)=>{let{className:a,...s}=e;return(0,t.jsx)(r.$G,{ref:l,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})});g.displayName=r.$G.displayName;let p=s.forwardRef((e,l)=>{let{className:a,children:s,position:i="popper",...n}=e;return(0,t.jsx)(r.h_,{children:(0,t.jsxs)(r.VY,{ref:l,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...n,children:[(0,t.jsx)(v,{}),(0,t.jsx)(r.l_,{className:(0,c.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,t.jsx)(g,{})]})})});p.displayName=r.VY.displayName;let f=s.forwardRef((e,l)=>{let{className:a,...s}=e;return(0,t.jsx)(r.__,{ref:l,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})});f.displayName=r.__.displayName;let y=s.forwardRef((e,l)=>{let{className:a,children:s,...i}=e;return(0,t.jsxs)(r.ck,{ref:l,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.wU,{children:(0,t.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(r.eT,{children:s})]})});y.displayName=r.ck.displayName;let m=s.forwardRef((e,l)=>{let{className:a,...s}=e;return(0,t.jsx)(r.Z0,{ref:l,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...s})});m.displayName=r.Z0.displayName},8390:function(e,l,a){a.d(l,{i:function(){return n}});var t=a(7437),s=a(2265),r=a(6072),i=a(9311);let n=s.forwardRef((e,l)=>{let{className:a,...s}=e;return(0,t.jsxs)(r.fC,{ref:l,className:(0,i.cn)("relative flex w-full touch-none select-none items-center",a),...s,children:[(0,t.jsx)(r.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,t.jsx)(r.e6,{className:"absolute h-full bg-primary"})}),(0,t.jsx)(r.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});n.displayName=r.fC.displayName},8850:function(e,l,a){a.d(l,{L:function(){return n}});var t=a(2265),s=a(164);let r=null,i=!1,n=()=>{let[e,l]=(0,t.useState)(r||[]),[a,n]=(0,t.useState)(!r);return(0,t.useEffect)(()=>{if(r){l(r),n(!1);return}if(i)return;let e=async()=>{i=!0;try{console.log("Loading categories...");let e=await s.h.categories.getAll();console.log("Categories API response:",e);let a=[];Array.isArray(e)?(a=e.filter(e=>e.isActive),console.log("Using direct array format")):e&&e.data&&Array.isArray(e.data)?(a=e.data.filter(e=>e.isActive),console.log("Using data format")):e&&e.categories&&Array.isArray(e.categories)&&(a=e.categories.filter(e=>e.isActive),console.log("Using categories format")),a=a.map(e=>({...e,level:e.level||0,parentId:e.parentId||void 0,children:e.children||[]})),console.log("Formatted categories:",a),r=a,l(a)}catch(e){console.error("Failed to load categories:",e)}finally{n(!1),i=!1}};e()},[]),{categories:e,loading:a}}},1211:function(e,l,a){a.d(l,{M:function(){return o},r:function(){return n}});var t=a(2265),s=a(164);let r=null,i=!1,n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[l,a]=(0,t.useState)(r||[]),[n,o]=(0,t.useState)(!r),[c,d]=(0,t.useState)(null),u=(0,t.useCallback)(async()=>{if(r&&!e.category&&!e.search){a(r),o(!1);return}if(!i){i=!0;try{o(!0),d(null);let l=await s.h.products.getAll(e),t=[];console.log("\uD83D\uDD0D Processing response format:",{hasData:!!(null==l?void 0:l.data),dataIsArray:Array.isArray(null==l?void 0:l.data),hasSuccess:null==l?void 0:l.success,hasProducts:!!(null==l?void 0:l.products),productsIsArray:Array.isArray(null==l?void 0:l.products),isDirectArray:Array.isArray(l)}),l&&l.data&&Array.isArray(l.data)?(t=l.data,console.log("✅ Using direct data format, count:",t.length)):l&&!0===l.success&&l.data&&l.data.products&&Array.isArray(l.data.products)?(t=l.data.products,console.log("✅ Using nested data.products format, count:",t.length)):l&&l.products&&Array.isArray(l.products)?(t=l.products,console.log("✅ Using direct products format, count:",t.length)):l&&l.data&&Array.isArray(l.data)?(t=l.data,console.log("✅ Using direct data array format, count:",t.length)):Array.isArray(l)&&(t=l,console.log("✅ Using direct array format, count:",t.length)),e.category||e.search||(r=t),0===t.length&&console.warn("\uD83D\uDEA8 No products found"),a(t)}catch(e){d("Не удалось загрузить товары"),console.error("Load error:",e)}finally{o(!1),i=!1}}},[e.category,e.search]);(0,t.useEffect)(()=>{console.log("\uD83D\uDD27 PRODUCTS HOOK - Component mounted or options changed, calling loadProducts"),u()},[u]);let b=(0,t.useCallback)(()=>{e.category||e.search||(r=null),u()},[u]);return{products:l,loading:n,error:c,refreshProducts:b}},o=(e,l,a)=>{let s=(0,t.useMemo)(()=>(console.log("\uD83D\uDD0D FILTER DEBUG - Starting filter:",{totalProducts:e.length,selectedCategories:a.selectedCategories,priceRange:a.priceRange}),e.filter(e=>{let l=e.price>=a.priceRange[0]&&e.price<=a.priceRange[1],t=!0;a.selectedCategories.length>0&&(t=e.categoryId&&e.categoryId._id?a.selectedCategories.includes(e.categoryId._id):!!e.category&&!!e.category._id&&a.selectedCategories.includes(e.category._id));let s=0===a.selectedCountries.length||e.country&&a.selectedCountries.includes(e.country),r=!0;if(Object.keys(a.selectedFilters).length>0&&e.attributes){for(let[l,t]of Object.entries(a.selectedFilters))if(t.length>0){let a=e.attributes[l];Array.isArray(a)?r=r&&t.some(e=>a.includes(e)):"string"==typeof a?r=r&&t.includes(a):"number"==typeof a&&(r=r&&t.includes(a.toString()))}}return l&&t&&s&&r})),[e,a]);return s}}}]);