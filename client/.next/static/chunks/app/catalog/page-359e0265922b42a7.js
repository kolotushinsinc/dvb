(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43],{8063:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var s=r(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s.Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},5680:function(e,t,r){Promise.resolve().then(r.bind(r,3829))},3829:function(e,t,r){"use strict";r.r(t);var s=r(7437),a=r(2265),l=r(1088),c=r(1517),n=r(3023),i=r(7810),o=r(9670),d=r(5340),x=r(1827),h=r(1609),m=r(7478),u=r(1211),g=r(1424),p=r(1396),y=r.n(p),f=r(7960),j=r(9613),v=r(1002),b=r(6036),N=r(3241),w=r(1980),A=r(8239);t.default=()=>{let[e,t]=(0,a.useState)({priceRange:[0,15e3],selectedCategories:[],selectedFilters:{},selectedCountries:[]}),{toggleFavorite:r,isFavorite:p,isLoggedIn:k,showAuthModal:C,setShowAuthModal:D}=(0,h.r)(),{categories:_,isLoading:S}=(0,m.L)(),{products:z,loading:I,error:P}=(0,u.r)(),R=(0,u.M)(z,_,e),F=async(e,t)=>{if(t.preventDefault(),t.stopPropagation(),!k){D(!0);return}try{await r(e._id);let t=p(e._id)?"Товар удален из избранного":"Товар добавлен в избранное";g.Am.success(t)}catch(e){g.Am.error("Не удалось добавить товар в избранное")}},O=e=>new Intl.NumberFormat("ru-RU").format(e)+" ₽";return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-cream-50 to-white",children:[(0,s.jsx)(l.Header,{}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,s.jsxs)("div",{className:"mb-12 text-center md:text-left",children:[(0,s.jsx)("div",{className:"inline-block mb-4",children:(0,s.jsx)("span",{className:"text-sm text-charcoal-500 uppercase tracking-wider font-medium bg-secondary-50 px-3 py-1 rounded-full",children:"Все товары"})}),(0,s.jsxs)("h1",{className:"font-display text-3xl lg:text-5xl font-bold text-charcoal-800 mb-4 tracking-tight",children:["Каталог ",(0,s.jsx)("span",{className:"premium-text",children:"товаров"})]}),(0,s.jsxs)("p",{className:"text-lg text-charcoal-600 max-w-2xl md:mx-0 mx-auto",children:["Найдено товаров: ",(0,s.jsx)("span",{className:"font-semibold",children:R&&Array.isArray(R)?R.length:0})]})]}),(0,s.jsxs)("div",{className:"flex gap-8",children:[(0,s.jsx)(w.V,{categories:_,products:z,onFilterChange:e=>t(e)}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8",children:S||I?Array.from({length:6}).map((e,t)=>(0,s.jsx)("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-secondary-100 h-[400px] flex items-center justify-center",children:(0,s.jsx)(j.Loader,{size:"lg",text:"Загрузка..."})},t)):P?(0,s.jsx)("div",{className:"col-span-full",children:(0,s.jsx)(v.F7,{onRetry:()=>window.location.reload()})}):R&&Array.isArray(R)&&R.length>0?R.map((e,t)=>(0,s.jsx)(f.SlideIn,{delay:50*t,children:(0,s.jsxs)("div",{className:"group bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2 overflow-hidden border border-secondary-100 premium-shadow",children:[(0,s.jsxs)("div",{className:"relative overflow-hidden bg-secondary-50 h-72",children:[(0,s.jsx)(y(),{href:"/product/".concat(e.slug),children:(0,s.jsx)(A.d,{src:e.mainImage||"/placeholder-product.jpg",alt:e.name,width:500,height:280,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"})}),(0,s.jsxs)("div",{className:"absolute top-4 left-4 flex flex-col space-y-2",children:[e.isBrandNew&&(0,s.jsx)("span",{className:"bg-gradient-to-r from-gold-400 to-gold-600 text-white text-xs px-3 py-1 rounded-full font-semibold shadow-md",children:"НОВОЕ"}),e.isOnSale&&(0,s.jsx)("span",{className:"bg-gradient-to-r from-accent-500 to-accent-600 text-white text-xs px-3 py-1 rounded-full font-semibold shadow-md",children:"-20%"})]}),(0,s.jsxs)("div",{className:"absolute top-4 right-4 flex flex-col space-y-3 transition-all duration-300 opacity-0 group-hover:opacity-100 transform translate-x-4 group-hover:translate-x-0",children:[(0,s.jsx)(n.z,{size:"icon",variant:"secondary",className:"w-11 h-11 rounded-full bg-white/90 backdrop-blur-sm hover:bg-white shadow-lg hover:shadow-xl ".concat(p(e._id)?"text-accent-500 hover:text-accent-600 hover:scale-110 transition-all duration-300":"text-charcoal-600 hover:text-accent-500 hover:scale-110 transition-all duration-300"),onClick:t=>F(e,t),children:(0,s.jsx)(i.Z,{className:"w-5 h-5 ".concat(p(e._id)?"fill-current":"")})}),(0,s.jsx)(N.i,{product:e,children:(0,s.jsx)(n.z,{size:"icon",variant:"secondary",className:"w-11 h-11 rounded-full bg-white/90 backdrop-blur-sm hover:bg-white shadow-lg hover:shadow-xl text-charcoal-600 hover:text-primary-500 hover:scale-110 transition-all duration-300",onClick:e=>{e.preventDefault(),e.stopPropagation()},children:(0,s.jsx)(o.Z,{className:"w-5 h-5"})})})]}),(0,s.jsx)("div",{className:"absolute bottom-4 left-4",children:(0,s.jsx)("span",{className:"bg-white/90 backdrop-blur-sm text-charcoal-700 text-xs px-4 py-1.5 rounded-full font-medium shadow-sm border border-white/50",children:e.country})})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("span",{className:"text-sm text-charcoal-500 uppercase tracking-wider font-medium bg-secondary-50 px-3 py-1 rounded-full",children:e.categoryId?e.categoryId.name:e.category?e.category.name:""}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 bg-gold-50 px-2 py-1 rounded-full",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 fill-gold-500 text-gold-500"}),(0,s.jsx)("span",{className:"text-sm text-charcoal-700 font-medium",children:e.rating||4.5}),(0,s.jsxs)("span",{className:"text-sm text-charcoal-500",children:["(",e.reviewsCount||12,")"]})]})]}),(0,s.jsx)(y(),{href:"/product/".concat(e.slug),children:(0,s.jsx)("h3",{className:"font-heading text-lg font-bold text-charcoal-800 mb-3 group-hover:text-primary-500 transition-colors line-clamp-2 h-14",children:e.name})}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-secondary-100",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-xl font-bold text-charcoal-800",children:O(e.price)}),e.originalPrice&&(0,s.jsx)("span",{className:"text-sm text-charcoal-500 line-through",children:O(e.originalPrice)})]}),(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary-50 group-hover:bg-primary-100 flex items-center justify-center transition-all",children:(0,s.jsx)("span",{className:"text-sm text-primary-500 group-hover:text-primary-600",children:"→"})})]})]})]})},e._id)):(0,s.jsx)("div",{className:"col-span-full text-center py-16 bg-white rounded-2xl shadow-lg border border-secondary-100 premium-card",children:(0,s.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-secondary-50 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)(x.Z,{className:"w-10 h-10 text-secondary-300"})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-charcoal-800 mb-4",children:"Товары не найдены"}),(0,s.jsx)("p",{className:"text-charcoal-600 mb-8",children:"Попробуйте изменить параметры фильтрации или обновить страницу"}),(0,s.jsx)(n.z,{variant:"outline",onClick:()=>window.location.reload(),className:"border-2 border-secondary-200 hover:border-primary-300 px-6 py-2",children:"Обновить страницу"})]})})})})]})]}),(0,s.jsx)(b.Q,{isOpen:C,onClose:()=>D(!1),message:"Для добавления товара в избранное необходимо войти в систему"}),(0,s.jsx)(c.Footer,{})]})}},1002:function(e,t,r){"use strict";r.d(t,{F7:function(){return i},TX:function(){return o},Xr:function(){return n}});var s=r(7437);r(2265);var a=r(8063),l=r(2549),c=r(3023);let n=e=>{let{error:t,onDismiss:r,className:n=""}=e;return t?(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 ".concat(n),children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(a.Z,{className:"h-5 w-5 text-red-400"})}),(0,s.jsxs)("div",{className:"ml-3 flex-1",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Ошибка"}),(0,s.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,s.jsx)("p",{children:t})})]}),r&&(0,s.jsx)("div",{className:"ml-auto pl-3",children:(0,s.jsx)("div",{className:"-mx-1.5 -my-1.5",children:(0,s.jsx)(c.z,{variant:"ghost",size:"sm",onClick:r,className:"text-red-500 hover:text-red-700",children:(0,s.jsx)(l.Z,{className:"h-4 w-4"})})})})]})}):null},i=e=>{let{onRetry:t,className:r=""}=e;return(0,s.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 ".concat(r),children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(a.Z,{className:"h-5 w-5 text-yellow-400"})}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Проблема с подключением"}),(0,s.jsx)("div",{className:"mt-2 text-sm text-yellow-700",children:(0,s.jsx)("p",{children:"Не удалось подключиться к серверу. Пожалуйста, проверьте ваше интернет-соединение."})}),t&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(c.z,{variant:"outline",size:"sm",onClick:t,className:"text-yellow-700 border-yellow-300 hover:bg-yellow-100",children:"Попробовать снова"})})]})]})})},o=e=>{let{message:t="Страница не найдена",className:r=""}=e;return(0,s.jsx)("div",{className:"min-h-[400px] flex items-center justify-center ".concat(r),children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-6xl font-bold text-gray-900",children:"404"}),(0,s.jsx)("p",{className:"mt-4 text-lg text-gray-600",children:t})]})})}},8239:function(e,t,r){"use strict";r.d(t,{d:function(){return n}});var s=r(7437),a=r(2265),l=r(6691),c=r.n(l);let n=e=>{let{src:t,alt:r,width:l=400,height:n=300,className:i="",priority:o=!1,placeholder:d="empty",blurDataURL:x}=e,[h,m]=(0,a.useState)(!0),[u,g]=(0,a.useState)(!1),p=t?t.replace("https://api.dvberry.ru",""):t;return(0,s.jsxs)("div",{className:"relative overflow-hidden ".concat(i),children:[h&&(0,s.jsx)("div",{className:"absolute inset-0 bg-gray-200 animate-pulse flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Загрузка..."})}),u?(0,s.jsx)("div",{className:"absolute inset-0 bg-gray-200 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Изображение недоступно"})}):(0,s.jsx)(c(),{src:p,alt:r,width:l,height:n,className:"transition-opacity duration-300 ".concat(h?"opacity-0":"opacity-100"),priority:o,placeholder:d,blurDataURL:x,onLoadingComplete:()=>m(!1),onError:()=>g(!0),sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"})]})}},1211:function(e,t,r){"use strict";r.d(t,{M:function(){return i},r:function(){return n}});var s=r(2265),a=r(164);let l=null,c=!1,n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,r]=(0,s.useState)(l||[]),[n,i]=(0,s.useState)(!l),[o,d]=(0,s.useState)(null),x=(0,s.useCallback)(async()=>{if(l&&!e.category&&!e.search){r(l),i(!1);return}if(!c){c=!0;try{i(!0),d(null);let t=await a.h.products.getAll(e),s=[];console.log("\uD83D\uDD0D Processing response format:",{hasData:!!(null==t?void 0:t.data),dataIsArray:Array.isArray(null==t?void 0:t.data),hasSuccess:null==t?void 0:t.success,hasProducts:!!(null==t?void 0:t.products),productsIsArray:Array.isArray(null==t?void 0:t.products),isDirectArray:Array.isArray(t)}),t&&t.data&&Array.isArray(t.data)?(s=t.data,console.log("✅ Using direct data format, count:",s.length)):t&&!0===t.success&&t.data&&t.data.products&&Array.isArray(t.data.products)?(s=t.data.products,console.log("✅ Using nested data.products format, count:",s.length)):t&&t.products&&Array.isArray(t.products)?(s=t.products,console.log("✅ Using direct products format, count:",s.length)):t&&t.data&&Array.isArray(t.data)?(s=t.data,console.log("✅ Using direct data array format, count:",s.length)):Array.isArray(t)&&(s=t,console.log("✅ Using direct array format, count:",s.length)),e.category||e.search||(l=s),0===s.length&&console.warn("\uD83D\uDEA8 No products found"),r(s)}catch(e){d("Не удалось загрузить товары"),console.error("Load error:",e)}finally{i(!1),c=!1}}},[e.category,e.search]);(0,s.useEffect)(()=>{console.log("\uD83D\uDD27 PRODUCTS HOOK - Component mounted or options changed, calling loadProducts"),x()},[x]);let h=(0,s.useCallback)(()=>{e.category||e.search||(l=null),x()},[x]);return{products:t,loading:n,error:o,refreshProducts:h}},i=(e,t,r)=>{let a=(0,s.useMemo)(()=>(console.log("\uD83D\uDD0D FILTER DEBUG - Starting filter:",{totalProducts:e.length,selectedCategories:r.selectedCategories,priceRange:r.priceRange}),e.filter(e=>{let t=e.price>=r.priceRange[0]&&e.price<=r.priceRange[1],s=!0;r.selectedCategories.length>0&&(s=e.categoryId&&e.categoryId._id?r.selectedCategories.includes(e.categoryId._id):!!e.category&&!!e.category._id&&r.selectedCategories.includes(e.category._id));let a=0===r.selectedCountries.length||e.country&&r.selectedCountries.includes(e.country),l=!0;if(Object.keys(r.selectedFilters).length>0&&e.attributes){for(let[t,s]of Object.entries(r.selectedFilters))if(s.length>0){let r=e.attributes[t];Array.isArray(r)?l=l&&s.some(e=>r.includes(e)):"string"==typeof r?l=l&&s.includes(r):"number"==typeof r&&(l=l&&s.includes(r.toString()))}}return t&&s&&a&&l})),[e,r]);return a}}},function(e){e.O(0,[312,85,787,10,522,148,548,631,980,971,864,560],function(){return e(e.s=5680)}),_N_E=e.O()}]);