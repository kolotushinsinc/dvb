(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[583],{1291:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var s=r(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},7158:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var s=r(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},4891:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var s=r(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s.Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},9883:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var s=r(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7341:function(e,t,r){Promise.resolve().then(r.bind(r,3947)),Promise.resolve().then(r.bind(r,1517)),Promise.resolve().then(r.bind(r,1088))},3947:function(e,t,r){"use strict";r.r(t);var s=r(7437),a=r(2265),l=r(4033),o=r(3023),c=r(7810),n=r(9670),i=r(5340),d=r(3505),u=r(1827),h=r(8554),m=r(1609),x=r(7478),g=r(1211),p=r(1424),f=r(1396),y=r.n(f),v=r(7960),b=r(9613),j=r(6036),w=r(3241),N=r(1980),C=r(1945);t.default=function(){let e=(0,l.useParams)(),t=(0,l.useSearchParams)(),r=e.category,f=t.get("search")||"",[A,D]=(0,a.useState)({priceRange:[0,15e3],selectedCategories:[],selectedFilters:{},selectedCountries:[]}),[k,_]=(0,a.useState)(null),{addItem:P}=(0,h.j)(),{toggleFavorite:S,isFavorite:Z,isLoggedIn:I,showAuthModal:L,setShowAuthModal:R}=(0,m.r)(),{categories:O,isLoading:U}=(0,x.L)(),{products:z,loading:E}=(0,g.r)({category:r}),M=(0,g.M)(z,O,A),F=(0,a.useMemo)(()=>f?M.filter(e=>{var t;return e.name.toLowerCase().includes(f.toLowerCase())||(null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(f.toLowerCase()))}):M,[M,f]),B=O.find(e=>e.slug===r);(0,a.useEffect)(()=>{O.length>0&&!B?_("Категория не найдена"):B&&!B.isActive&&_("Категория неактивна")},[O,B]);let T=(e,t)=>{t.preventDefault(),t.stopPropagation(),P(e),p.Am.success("Товар добавлен в корзину!")},q=async(e,t)=>{if(t.preventDefault(),t.stopPropagation(),!I){R(!0);return}try{await S(e._id);let t=Z(e._id)?"Товар удален из избранного":"Товар добавлен в избранное";p.Am.success(t)}catch(e){p.Am.error("Не удалось добавить товар в избранное")}},G=e=>new Intl.NumberFormat("ru-RU").format(e)+" ₽",H=e=>{switch(e){case"glasses":return"Очки";case"clothing":return"Одежда";case"shoes":return"Обувь";case"accessories":return"Аксессуары";case"sale":return"Распродажа";case"new":return"Новинки";default:return e}};return U||E?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-cream-50 to-white",children:(0,s.jsx)(b.Loader,{variant:"page",size:"xl",text:'Загрузка товаров категории "'.concat(H(r),'"')})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-cream-50 to-white",children:[(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,s.jsxs)("div",{className:"mb-12 text-center md:text-left",children:[(0,s.jsx)("div",{className:"inline-block mb-4",children:(0,s.jsx)("span",{className:"text-sm text-charcoal-500 uppercase tracking-wider font-medium bg-secondary-50 px-3 py-1 rounded-full",children:"Каталог"})}),(0,s.jsxs)("h1",{className:"font-display text-3xl lg:text-5xl font-bold text-charcoal-800 mb-4 tracking-tight",children:[H(r)," ",(0,s.jsx)("span",{className:"premium-text",children:"коллекция"})]}),(0,s.jsxs)("p",{className:"text-lg text-charcoal-600 max-w-2xl md:mx-0 mx-auto",children:["Найдено товаров: ",(0,s.jsx)("span",{className:"font-semibold",children:F.length}),f&&(0,s.jsxs)("span",{className:"ml-2",children:['по запросу "',(0,s.jsx)("span",{className:"font-semibold",children:f}),'"']})]})]}),(0,s.jsxs)("div",{className:"flex gap-8",children:[(0,s.jsx)(N.V,{categories:O,products:z,onFilterChange:e=>D(e),initialCategory:null==B?void 0:B._id}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8",children:F.map(e=>(0,s.jsx)(v.SlideIn,{children:(0,s.jsxs)("div",{className:"group bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2 overflow-hidden border border-secondary-100 premium-shadow",children:[(0,s.jsxs)("div",{className:"relative overflow-hidden bg-secondary-50 h-72",children:[(0,s.jsx)(C.w,{src:e.mainImage||"/placeholder-product.jpg",thumbnailSrc:e.thumbnailUrl,alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),(0,s.jsxs)("div",{className:"absolute top-4 left-4 flex flex-col space-y-2",children:[e.isBrandNew&&(0,s.jsx)("span",{className:"bg-gradient-to-r from-gold-400 to-gold-600 text-white text-xs px-3 py-1 rounded-full font-semibold shadow-md",children:"НОВОЕ"}),e.isOnSale&&(0,s.jsx)("span",{className:"bg-gradient-to-r from-accent-500 to-accent-600 text-white text-xs px-3 py-1 rounded-full font-semibold shadow-md",children:"-20%"})]}),(0,s.jsxs)("div",{className:"absolute top-4 right-4 flex flex-col space-y-3 transition-all duration-300 opacity-0 group-hover:opacity-100 transform translate-x-4 group-hover:translate-x-0",children:[(0,s.jsx)(o.z,{size:"icon",variant:"secondary",className:"w-11 h-11 rounded-full bg-white/90 backdrop-blur-sm hover:bg-white shadow-lg hover:shadow-xl ".concat(Z(e._id)?"text-accent-500 hover:text-accent-600 hover:scale-110 transition-all duration-300":"text-charcoal-600 hover:text-accent-500 hover:scale-110 transition-all duration-300"),onClick:t=>q(e,t),children:(0,s.jsx)(c.Z,{className:"w-5 h-5 ".concat(Z(e._id)?"fill-current":"")})}),(0,s.jsx)(w.i,{product:e,children:(0,s.jsx)(o.z,{size:"icon",variant:"secondary",className:"w-11 h-11 rounded-full bg-white/90 backdrop-blur-sm hover:bg-white shadow-lg hover:shadow-xl text-charcoal-600 hover:text-primary-500 hover:scale-110 transition-all duration-300",onClick:e=>{e.preventDefault(),e.stopPropagation()},children:(0,s.jsx)(n.Z,{className:"w-5 h-5"})})})]}),(0,s.jsx)("div",{className:"absolute bottom-4 left-4",children:(0,s.jsx)("span",{className:"bg-white/90 backdrop-blur-sm text-charcoal-700 text-xs px-4 py-1.5 rounded-full font-medium shadow-sm border border-white/50",children:e.country})})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("span",{className:"text-sm text-charcoal-500 uppercase tracking-wider font-medium bg-secondary-50 px-3 py-1 rounded-full",children:e.categoryId?e.categoryId.name:e.category?e.category.name:""}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 bg-gold-50 px-2 py-1 rounded-full",children:[(0,s.jsx)(i.Z,{className:"w-4 h-4 fill-gold-500 text-gold-500"}),(0,s.jsx)("span",{className:"text-sm text-charcoal-700 font-medium",children:e.rating||4.5}),(0,s.jsxs)("span",{className:"text-sm text-charcoal-500",children:["(",e.reviewsCount||12,")"]})]})]}),(0,s.jsx)(y(),{href:"/product/".concat(e.slug),children:(0,s.jsx)("h3",{className:"font-heading text-lg font-bold text-charcoal-800 mb-3 group-hover:text-primary-500 transition-colors line-clamp-2 h-14 cursor-pointer",children:e.name})}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-secondary-100",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-xl font-bold text-charcoal-800",children:G(e.price)}),e.originalPrice&&(0,s.jsx)("span",{className:"text-sm text-charcoal-500 line-through",children:G(e.originalPrice)})]}),(0,s.jsx)(o.z,{size:"icon",className:"rounded-full bg-gradient-to-r from-primary-400 to-primary-500 hover:from-primary-500 hover:to-primary-600 shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-300",onClick:t=>T(e,t),children:(0,s.jsx)(d.Z,{className:"w-4 h-4"})})]})]})]})},e._id))}),0===F.length&&(0,s.jsx)("div",{className:"text-center py-16 bg-white rounded-2xl shadow-lg border border-secondary-100 premium-card",children:(0,s.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-secondary-50 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)(u.Z,{className:"w-10 h-10 text-secondary-300"})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-charcoal-800 mb-4",children:"По вашим критериям ничего не найдено"}),(0,s.jsx)("p",{className:"text-charcoal-600 mb-8",children:"Попробуйте изменить параметры фильтрации или выбрать другую категорию товаров"}),(0,s.jsx)(o.z,{variant:"outline",onClick:()=>{D({priceRange:[0,15e3],selectedCategories:B?[B._id]:[],selectedFilters:{},selectedCountries:[]})},className:"border-2 border-secondary-200 hover:border-primary-300 px-6 py-2",children:"Сбросить фильтры"})]})})]})]})]}),(0,s.jsx)(j.Q,{isOpen:L,onClose:()=>R(!1),message:"Для добавления товара в избранное необходимо войти в систему"})]})}},1211:function(e,t,r){"use strict";r.d(t,{M:function(){return n},r:function(){return c}});var s=r(2265),a=r(164);let l=null,o=!1,c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,r]=(0,s.useState)(l||[]),[c,n]=(0,s.useState)(!l),[i,d]=(0,s.useState)(null),u=(0,s.useCallback)(async()=>{if(l&&!e.category&&!e.search){r(l),n(!1);return}if(!o){o=!0;try{n(!0),d(null);let t=await a.h.products.getAll(e),s=[];console.log("\uD83D\uDD0D Processing response format:",{hasData:!!(null==t?void 0:t.data),dataIsArray:Array.isArray(null==t?void 0:t.data),hasSuccess:null==t?void 0:t.success,hasProducts:!!(null==t?void 0:t.products),productsIsArray:Array.isArray(null==t?void 0:t.products),isDirectArray:Array.isArray(t)}),t&&t.data&&Array.isArray(t.data)?(s=t.data,console.log("✅ Using direct data format, count:",s.length)):t&&!0===t.success&&t.data&&t.data.products&&Array.isArray(t.data.products)?(s=t.data.products,console.log("✅ Using nested data.products format, count:",s.length)):t&&t.products&&Array.isArray(t.products)?(s=t.products,console.log("✅ Using direct products format, count:",s.length)):t&&t.data&&Array.isArray(t.data)?(s=t.data,console.log("✅ Using direct data array format, count:",s.length)):Array.isArray(t)&&(s=t,console.log("✅ Using direct array format, count:",s.length)),e.category||e.search||(l=s),0===s.length&&console.warn("\uD83D\uDEA8 No products found"),r(s)}catch(e){d("Не удалось загрузить товары"),console.error("Load error:",e)}finally{n(!1),o=!1}}},[e.category,e.search]);(0,s.useEffect)(()=>{console.log("\uD83D\uDD27 PRODUCTS HOOK - Component mounted or options changed, calling loadProducts"),u()},[u]);let h=(0,s.useCallback)(()=>{e.category||e.search||(l=null),u()},[u]);return{products:t,loading:c,error:i,refreshProducts:h}},n=(e,t,r)=>{let a=(0,s.useMemo)(()=>(console.log("\uD83D\uDD0D FILTER DEBUG - Starting filter:",{totalProducts:e.length,selectedCategories:r.selectedCategories,priceRange:r.priceRange}),e.filter(e=>{let t=e.price>=r.priceRange[0]&&e.price<=r.priceRange[1],s=!0;r.selectedCategories.length>0&&(s=e.categoryId&&e.categoryId._id?r.selectedCategories.includes(e.categoryId._id):!!e.category&&!!e.category._id&&r.selectedCategories.includes(e.category._id));let a=0===r.selectedCountries.length||e.country&&r.selectedCountries.includes(e.country),l=!0;if(Object.keys(r.selectedFilters).length>0&&e.attributes){for(let[t,s]of Object.entries(r.selectedFilters))if(s.length>0){let r=e.attributes[t];Array.isArray(r)?l=l&&s.some(e=>r.includes(e)):"string"==typeof r?l=l&&s.includes(r):"number"==typeof r&&(l=l&&s.includes(r.toString()))}}return t&&s&&a&&l})),[e,r]);return a}}},function(e){e.O(0,[312,85,787,10,148,548,631,980,971,864,560],function(){return e(e.s=7341)}),_N_E=e.O()}]);