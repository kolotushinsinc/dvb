(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{6346:function(e,a,r){Promise.resolve().then(r.bind(r,3278))},3278:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return q}});var s=r(7437),l=r(2265),t=r(4033),c=r(1088),d=r(1517),n=r(3023),i=r(6110),o=r(1908),m=r(6672),x=r(5490),u=r(6369),h=r(9311);let g=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,s.jsx)(x.fC,{className:(0,h.cn)("grid gap-2",r),...l,ref:a})});g.displayName=x.fC.displayName;let f=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,s.jsx)(x.ck,{ref:a,className:(0,h.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...l,children:(0,s.jsx)(x.z$,{className:"flex items-center justify-center",children:(0,s.jsx)(u.Z,{className:"h-2.5 w-2.5 fill-current text-current"})})})});f.displayName=x.ck.displayName;var y=r(6775),p=r(9155),j=r(3067),N=r(4322),v=r(1961),b=r(1738),C=r(9036),w=r(8554),F=r(1424),_=r(1396),I=r.n(_),E=r(164),Z=r(8188),q=()=>{let e=(0,t.useRouter)(),{items:a,totalPrice:r,loading:x,clearCart:u}=(0,w.j)(),[h,_]=(0,l.useState)(!1),[q,A]=(0,l.useState)(300),[k,R]=(0,l.useState)({email:"",phone:"",firstName:"",lastName:"",address:"",city:"",state:"",postalCode:"",country:"Россия",paymentMethod:"card",cardNumber:"",cardExpiry:"",cardCVC:"",cardName:"",notes:""});(0,l.useEffect)(()=>{x||0!==a.length||(F.Am.error("Корзина пуста"),e.push("/cart"))},[a,x,e]),(0,l.useEffect)(()=>{A(r>5e3?0:300)},[r]);let V=e=>{let{name:a,value:r}=e.target;R(e=>({...e,[a]:r}))},O=()=>k.email&&k.phone&&k.firstName&&k.lastName&&k.address&&k.city&&k.postalCode?"card"!==k.paymentMethod||!!k.cardNumber&&!!k.cardExpiry&&!!k.cardCVC&&!!k.cardName||(F.Am.error("Пожалуйста, заполните все данные карты"),!1):(F.Am.error("Пожалуйста, заполните все обязательные поля"),!1),z=async r=>{if(r.preventDefault(),O())try{_(!0);let r=a.map(e=>({productId:e.product._id,quantity:e.quantity,size:e.size,color:e.color})),s={firstName:k.firstName,lastName:k.lastName,address:k.address,city:k.city,state:k.state,postalCode:k.postalCode,country:k.country,phone:k.phone},l=await E.h.orders.create(r,s);await u(),F.Am.success("Заказ успешно оформлен!"),e.push("/order-confirmation/".concat(l._id))}catch(e){F.Am.error(e.message||"Не удалось оформить заказ"),console.error("Checkout error:",e)}finally{_(!1)}},Y=e=>new Intl.NumberFormat("ru-RU").format(e)+" ₽",D=r+q;return x?(0,s.jsx)("div",{className:"min-h-screen bg-cream-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Загрузка..."})]})}):0===a.length?null:(0,s.jsxs)("div",{className:"min-h-screen bg-cream-50",children:[(0,s.jsx)(c.default,{}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)(I(),{href:"/cart",className:"flex items-center text-primary hover:text-indigo-700 mb-4",children:[(0,s.jsx)(j.Z,{className:"w-4 h-4 mr-2"}),"Вернуться в корзину"]}),(0,s.jsx)("h1",{className:"font-display text-3xl lg:text-4xl font-bold text-gray-900 mb-2",children:"Оформление заказа"}),(0,s.jsx)("p",{className:"text-lg text-gray-600",children:"Заполните данные для оформления заказа"})]}),(0,s.jsxs)("form",{onSubmit:z,className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-8",children:[(0,s.jsxs)(i.Zb,{children:[(0,s.jsx)(i.Ol,{children:(0,s.jsxs)(i.ll,{className:"flex items-center text-gray-900",children:[(0,s.jsx)(N.Z,{className:"w-5 h-5 mr-2"}),"Контактная информация"]})}),(0,s.jsx)(i.aY,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"email",children:"Email *"}),(0,s.jsx)(o.I,{id:"email",name:"email",type:"email",required:!0,value:k.email,onChange:V,placeholder:"your@email.com",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"phone",children:"Телефон *"}),(0,s.jsx)(o.I,{id:"phone",name:"phone",type:"tel",required:!0,value:k.phone,onChange:V,placeholder:"+7 (999) 123-45-67",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]})]})})]}),(0,s.jsxs)(i.Zb,{children:[(0,s.jsx)(i.Ol,{children:(0,s.jsxs)(i.ll,{className:"flex items-center text-gray-900",children:[(0,s.jsx)(v.Z,{className:"w-5 h-5 mr-2"}),"Адрес доставки"]})}),(0,s.jsxs)(i.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"firstName",children:"Имя *"}),(0,s.jsx)(o.I,{id:"firstName",name:"firstName",required:!0,value:k.firstName,onChange:V,placeholder:"Иван",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"lastName",children:"Фамилия *"}),(0,s.jsx)(o.I,{id:"lastName",name:"lastName",required:!0,value:k.lastName,onChange:V,placeholder:"Иванов",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"address",children:"Адрес *"}),(0,s.jsx)(o.I,{id:"address",name:"address",required:!0,value:k.address,onChange:V,placeholder:"Ул. Ленина, д. 1, кв. 1",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"city",children:"Город *"}),(0,s.jsx)(o.I,{id:"city",name:"city",required:!0,value:k.city,onChange:V,placeholder:"Москва",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"state",children:"Область/край"}),(0,s.jsx)(o.I,{id:"state",name:"state",value:k.state,onChange:V,placeholder:"Московская обл.",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"postalCode",children:"Почтовый индекс *"}),(0,s.jsx)(o.I,{id:"postalCode",name:"postalCode",required:!0,value:k.postalCode,onChange:V,placeholder:"123456",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"country",children:"Страна"}),(0,s.jsx)(o.I,{id:"country",name:"country",value:k.country,onChange:V,className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]})]})]}),(0,s.jsxs)(i.Zb,{children:[(0,s.jsx)(i.Ol,{children:(0,s.jsxs)(i.ll,{className:"flex items-center text-gray-900",children:[(0,s.jsx)(b.Z,{className:"w-5 h-5 mr-2"}),"Способ оплаты"]})}),(0,s.jsxs)(i.aY,{className:"space-y-6",children:[(0,s.jsxs)(g,{value:k.paymentMethod,onValueChange:e=>{R(a=>({...a,paymentMethod:e}))},className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(f,{value:"card",id:"card"}),(0,s.jsx)(m._,{htmlFor:"card",className:"cursor-pointer text-gray-900",children:"Банковская карта"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(f,{value:"cash",id:"cash"}),(0,s.jsx)(m._,{htmlFor:"cash",className:"cursor-pointer text-gray-900",children:"Наличные при получении"})]})]}),"card"===k.paymentMethod&&(0,s.jsxs)("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"cardName",children:"Имя на карте *"}),(0,s.jsx)(o.I,{id:"cardName",name:"cardName",required:!0,value:k.cardName,onChange:V,placeholder:"IVAN IVANOV",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"cardNumber",children:"Номер карты *"}),(0,s.jsx)(o.I,{id:"cardNumber",name:"cardNumber",required:!0,value:k.cardNumber,onChange:V,placeholder:"0000 0000 0000 0000",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"cardExpiry",children:"Срок действия *"}),(0,s.jsx)(o.I,{id:"cardExpiry",name:"cardExpiry",required:!0,value:k.cardExpiry,onChange:V,placeholder:"ММ/ГГ",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"cardCVC",children:"CVC *"}),(0,s.jsx)(o.I,{id:"cardCVC",name:"cardCVC",required:!0,value:k.cardCVC,onChange:V,placeholder:"000",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,s.jsx)(C.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Ваши платежные данные защищены и безопасны"})]})]})]})]}),(0,s.jsxs)(i.Zb,{children:[(0,s.jsx)(i.Ol,{children:(0,s.jsx)(i.ll,{className:"text-gray-900",children:"Комментарий к заказу"})}),(0,s.jsx)(i.aY,{children:(0,s.jsx)(o.I,{id:"notes",name:"notes",value:k.notes,onChange:V,placeholder:"Любые дополнительные пожелания или комментарии",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})})]}),(0,s.jsx)(n.z,{type:"submit",className:"w-full py-6 text-lg",disabled:h,children:h?"Оформление заказа...":"Оплатить ".concat(Y(D))})]}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)(i.Zb,{className:"sticky top-8",children:[(0,s.jsx)(i.Ol,{children:(0,s.jsx)(i.ll,{className:"text-gray-900",children:"Ваш заказ"})}),(0,s.jsxs)(i.aY,{className:"space-y-4",children:[(0,s.jsx)("div",{className:"space-y-4 max-h-80 overflow-y-auto pr-2",children:a.map(e=>{var a;return(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-md overflow-hidden flex-shrink-0",children:e.product.mainImage?(0,s.jsx)("img",{src:e.product.mainImage,alt:e.product.name,className:"w-full h-full object-cover"}):e.product.images&&e.product.images.length>0?(0,s.jsx)("img",{src:e.product.images[0].url,alt:e.product.name,className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-200",children:(0,s.jsx)(N.Z,{className:"h-6 w-6 text-gray-400"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"font-medium truncate text-gray-900",children:e.product.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[e.quantity," \xd7 ",Y(e.product.price)]}),(e.size||e.color)&&(0,s.jsxs)("div",{className:"flex gap-2 mt-1 items-center",children:[e.size&&(0,s.jsxs)(p.C,{variant:"secondary",className:"text-xs",children:["Размер: ",e.size]}),e.color&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Цвет:"}),(0,s.jsx)("div",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:(null===(a=(0,Z.OA)(e.color))||void 0===a?void 0:a.value)||"#CCCCCC",borderColor:"Белый"===e.color?"#E5E7EB":void 0},title:e.color})]})]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsx)("p",{className:"font-medium",children:Y(e.product.price*e.quantity)})})]},"".concat(e._id,"-").concat(e.size||"","-").concat(e.color||""))})}),(0,s.jsx)(y.Z,{}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-700",children:"Товары"}),(0,s.jsx)("span",{className:"text-gray-900",children:Y(r)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-700",children:"Доставка"}),(0,s.jsx)("span",{className:"text-gray-900",children:0===q?"Бесплатно":Y(q)})]}),q>0&&(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Бесплатная доставка при заказе от 5000 ₽"})]}),(0,s.jsx)(y.Z,{}),(0,s.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[(0,s.jsx)("span",{className:"text-gray-700",children:"Итого"}),(0,s.jsx)("span",{className:"text-gray-900",children:Y(D)})]})]})]})})]})]}),(0,s.jsx)(d.default,{})]})}},9155:function(e,a,r){"use strict";r.d(a,{C:function(){return d}});var s=r(7437);r(2265);var l=r(9213),t=r(9311);let c=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:a,variant:r,...l}=e;return(0,s.jsx)("div",{className:(0,t.cn)(c({variant:r}),a),...l})}},6110:function(e,a,r){"use strict";r.d(a,{Ol:function(){return d},SZ:function(){return i},Zb:function(){return c},aY:function(){return o},ll:function(){return n}});var s=r(7437),l=r(2265),t=r(9311);let c=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,s.jsx)("div",{ref:a,className:(0,t.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...l})});c.displayName="Card";let d=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,s.jsx)("div",{ref:a,className:(0,t.cn)("flex flex-col space-y-1.5 p-6",r),...l})});d.displayName="CardHeader";let n=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,s.jsx)("h3",{ref:a,className:(0,t.cn)("text-2xl font-semibold leading-none tracking-tight",r),...l})});n.displayName="CardTitle";let i=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,s.jsx)("p",{ref:a,className:(0,t.cn)("text-sm text-muted-foreground",r),...l})});i.displayName="CardDescription";let o=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,s.jsx)("div",{ref:a,className:(0,t.cn)("p-6 pt-0",r),...l})});o.displayName="CardContent";let m=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,s.jsx)("div",{ref:a,className:(0,t.cn)("flex items-center p-6 pt-0",r),...l})});m.displayName="CardFooter"},6672:function(e,a,r){"use strict";r.d(a,{_:function(){return i}});var s=r(7437),l=r(2265),t=r(6743),c=r(9213),d=r(9311);let n=(0,c.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),i=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,s.jsx)(t.f,{ref:a,className:(0,d.cn)(n(),r),...l})});i.displayName=t.f.displayName},6775:function(e,a,r){"use strict";r.d(a,{Z:function(){return d}});var s=r(7437),l=r(2265),t=r(6823),c=r(9311);let d=l.forwardRef((e,a)=>{let{className:r,orientation:l="horizontal",decorative:d=!0,...n}=e;return(0,s.jsx)(t.f,{ref:a,decorative:d,orientation:l,className:(0,c.cn)("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",r),...n})});d.displayName=t.f.displayName},8188:function(e,a,r){"use strict";r.d(a,{OA:function(){return l}});let s=[{name:"Черный",value:"#000000"},{name:"Белый",value:"#FFFFFF"},{name:"Красный",value:"#FF0000"},{name:"Синий",value:"#0000FF"},{name:"Зеленый",value:"#008000"},{name:"Желтый",value:"#FFFF00"},{name:"Оранжевый",value:"#FFA500"},{name:"Фиолетовый",value:"#800080"},{name:"Розовый",value:"#FFC0CB"},{name:"Коричневый",value:"#A52A2A"},{name:"Серый",value:"#808080"},{name:"Бежевый",value:"#F5F5DC"},{name:"Бирюзовый",value:"#40E0D0"},{name:"Лавандовый",value:"#E6E6FA"},{name:"Мятный",value:"#98FB98"},{name:"Коралловый",value:"#FF7F50"},{name:"Индиго",value:"#4B0082"},{name:"Золотой",value:"#FFD700"},{name:"Серебряный",value:"#C0C0C0"},{name:"Бордовый",value:"#800000"}],l=e=>s.find(a=>a.name.toLowerCase()===e.toLowerCase())}},function(e){e.O(0,[312,351,777,936,548,971,864,560],function(){return e(e.s=6346)}),_N_E=e.O()}]);