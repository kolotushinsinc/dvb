(()=>{var e={};e.id=285,e.ids=[285],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9582:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>c.a,__next_app__:()=>h,originalPathname:()=>x,pages:()=>m,routeModule:()=>u,tree:()=>o});var r=a(3137),t=a(4647),l=a(4183),c=a.n(l),i=a(1775),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);a.d(s,d);let n=r.AppPageRouteModule,o=["",{children:["checkout",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,1937)),"/Users/mikhailkolotushin/KolTech/projects/dvb/client/app/checkout/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,1335)),"/Users/mikhailkolotushin/KolTech/projects/dvb/client/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,1918,23)),"next/dist/client/components/not-found-error"]}],m=["/Users/mikhailkolotushin/KolTech/projects/dvb/client/app/checkout/page.tsx"],x="/checkout/page",h={require:a,loadChunk:()=>Promise.resolve()},u=new n({definition:{kind:t.x.APP_PAGE,page:"/checkout/page",pathname:"/checkout",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9169:(e,s,a)=>{Promise.resolve().then(a.bind(a,7189))},7189:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>F});var r=a(80),t=a(9885),l=a(7114),c=a(9006),i=a(3507),d=a(8384),n=a(7052),o=a(9424),m=a(3478),x=a(1557),h=a(4151),u=a(3161);let g=t.forwardRef(({className:e,...s},a)=>r.jsx(x.fC,{className:(0,u.cn)("grid gap-2",e),...s,ref:a}));g.displayName=x.fC.displayName;let p=t.forwardRef(({className:e,...s},a)=>r.jsx(x.ck,{ref:a,className:(0,u.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:r.jsx(x.z$,{className:"flex items-center justify-center",children:r.jsx(h.Z,{className:"h-2.5 w-2.5 fill-current text-current"})})}));p.displayName=x.ck.displayName;var j=a(501),y=a(4796),N=a(9803),f=a(7004),b=a(3303),v=a(8260),C=a(4901),w=a(442),_=a(9941),k=a(1440),q=a.n(k),I=a(7936),E=a(6037);let F=()=>{let e=(0,l.useRouter)(),{items:s,totalPrice:a,loading:x,clearCart:h}=(0,w.j)(),[u,k]=(0,t.useState)(!1),[F,P]=(0,t.useState)(300),[Z,A]=(0,t.useState)({email:"",phone:"",firstName:"",lastName:"",address:"",city:"",state:"",postalCode:"",country:"Россия",paymentMethod:"card",cardNumber:"",cardExpiry:"",cardCVC:"",cardName:"",notes:""});(0,t.useEffect)(()=>{x||0!==s.length||(_.Am.error("Корзина пуста"),e.push("/cart"))},[s,x,e]),(0,t.useEffect)(()=>{P(a>5e3?0:300)},[a]);let V=e=>{let{name:s,value:a}=e.target;A(e=>({...e,[s]:a}))},z=()=>Z.email&&Z.phone&&Z.firstName&&Z.lastName&&Z.address&&Z.city&&Z.postalCode?"card"!==Z.paymentMethod||!!Z.cardNumber&&!!Z.cardExpiry&&!!Z.cardCVC&&!!Z.cardName||(_.Am.error("Пожалуйста, заполните все данные карты"),!1):(_.Am.error("Пожалуйста, заполните все обязательные поля"),!1),M=async a=>{if(a.preventDefault(),z())try{k(!0);let a=s.map(e=>({productId:e.product._id,quantity:e.quantity,size:e.size,color:e.color})),r={firstName:Z.firstName,lastName:Z.lastName,address:Z.address,city:Z.city,state:Z.state,postalCode:Z.postalCode,country:Z.country,phone:Z.phone},t=await I.h.orders.create(a,r);await h(),_.Am.success("Заказ успешно оформлен!"),e.push(`/order-confirmation/${t._id}`)}catch(e){_.Am.error(e.message||"Не удалось оформить заказ"),console.error("Checkout error:",e)}finally{k(!1)}},O=e=>new Intl.NumberFormat("ru-RU").format(e)+" ₽",$=a+F;return x?r.jsx("div",{className:"min-h-screen bg-cream-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Загрузка..."})]})}):0===s.length?null:(0,r.jsxs)("div",{className:"min-h-screen bg-cream-50",children:[r.jsx(c.default,{}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)(q(),{href:"/cart",className:"flex items-center text-primary hover:text-indigo-700 mb-4",children:[r.jsx(N.Z,{className:"w-4 h-4 mr-2"}),"Вернуться в корзину"]}),r.jsx("h1",{className:"font-display text-3xl lg:text-4xl font-bold text-gray-900 mb-2",children:"Оформление заказа"}),r.jsx("p",{className:"text-lg text-gray-600",children:"Заполните данные для оформления заказа"})]}),(0,r.jsxs)("form",{onSubmit:M,className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-8",children:[(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"flex items-center text-gray-900",children:[r.jsx(f.Z,{className:"w-5 h-5 mr-2"}),"Контактная информация"]})}),r.jsx(n.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"email",children:"Email *"}),r.jsx(o.I,{id:"email",name:"email",type:"email",required:!0,value:Z.email,onChange:V,placeholder:"your@email.com",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"phone",children:"Телефон *"}),r.jsx(o.I,{id:"phone",name:"phone",type:"tel",required:!0,value:Z.phone,onChange:V,placeholder:"+7 (999) 123-45-67",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]})]})})]}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"flex items-center text-gray-900",children:[r.jsx(b.Z,{className:"w-5 h-5 mr-2"}),"Адрес доставки"]})}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"firstName",children:"Имя *"}),r.jsx(o.I,{id:"firstName",name:"firstName",required:!0,value:Z.firstName,onChange:V,placeholder:"Иван",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"lastName",children:"Фамилия *"}),r.jsx(o.I,{id:"lastName",name:"lastName",required:!0,value:Z.lastName,onChange:V,placeholder:"Иванов",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]})]}),(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"address",children:"Адрес *"}),r.jsx(o.I,{id:"address",name:"address",required:!0,value:Z.address,onChange:V,placeholder:"Ул. Ленина, д. 1, кв. 1",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"city",children:"Город *"}),r.jsx(o.I,{id:"city",name:"city",required:!0,value:Z.city,onChange:V,placeholder:"Москва",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"state",children:"Область/край"}),r.jsx(o.I,{id:"state",name:"state",value:Z.state,onChange:V,placeholder:"Московская обл.",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"postalCode",children:"Почтовый индекс *"}),r.jsx(o.I,{id:"postalCode",name:"postalCode",required:!0,value:Z.postalCode,onChange:V,placeholder:"123456",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]})]}),(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"country",children:"Страна"}),r.jsx(o.I,{id:"country",name:"country",value:Z.country,onChange:V,className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]})]})]}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"flex items-center text-gray-900",children:[r.jsx(v.Z,{className:"w-5 h-5 mr-2"}),"Способ оплаты"]})}),(0,r.jsxs)(n.aY,{className:"space-y-6",children:[(0,r.jsxs)(g,{value:Z.paymentMethod,onValueChange:e=>{A(s=>({...s,paymentMethod:e}))},className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(p,{value:"card",id:"card"}),r.jsx(m._,{htmlFor:"card",className:"cursor-pointer text-gray-900",children:"Банковская карта"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(p,{value:"cash",id:"cash"}),r.jsx(m._,{htmlFor:"cash",className:"cursor-pointer text-gray-900",children:"Наличные при получении"})]})]}),"card"===Z.paymentMethod&&(0,r.jsxs)("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"cardName",children:"Имя на карте *"}),r.jsx(o.I,{id:"cardName",name:"cardName",required:!0,value:Z.cardName,onChange:V,placeholder:"IVAN IVANOV",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"cardNumber",children:"Номер карты *"}),r.jsx(o.I,{id:"cardNumber",name:"cardNumber",required:!0,value:Z.cardNumber,onChange:V,placeholder:"0000 0000 0000 0000",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"cardExpiry",children:"Срок действия *"}),r.jsx(o.I,{id:"cardExpiry",name:"cardExpiry",required:!0,value:Z.cardExpiry,onChange:V,placeholder:"ММ/ГГ",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]}),(0,r.jsxs)("div",{children:[r.jsx(m._,{htmlFor:"cardCVC",children:"CVC *"}),r.jsx(o.I,{id:"cardCVC",name:"cardCVC",required:!0,value:Z.cardCVC,onChange:V,placeholder:"000",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[r.jsx(C.Z,{className:"w-4 h-4"}),r.jsx("span",{children:"Ваши платежные данные защищены и безопасны"})]})]})]})]}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{className:"text-gray-900",children:"Комментарий к заказу"})}),r.jsx(n.aY,{children:r.jsx(o.I,{id:"notes",name:"notes",value:Z.notes,onChange:V,placeholder:"Любые дополнительные пожелания или комментарии",className:"bg-gray-50 border-gray-200 focus:bg-white text-gray-900"})})]}),r.jsx(d.z,{type:"submit",className:"w-full py-6 text-lg",disabled:u,children:u?"Оформление заказа...":`Оплатить ${O($)}`})]}),r.jsx("div",{className:"lg:col-span-1",children:(0,r.jsxs)(n.Zb,{className:"sticky top-8",children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{className:"text-gray-900",children:"Ваш заказ"})}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[r.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto pr-2",children:s.map(e=>(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-md overflow-hidden flex-shrink-0",children:e.product.mainImage?r.jsx("img",{src:e.product.mainImage,alt:e.product.name,className:"w-full h-full object-cover"}):e.product.images&&e.product.images.length>0?r.jsx("img",{src:e.product.images[0].url,alt:e.product.name,className:"w-full h-full object-cover"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-200",children:r.jsx(f.Z,{className:"h-6 w-6 text-gray-400"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-medium truncate text-gray-900",children:e.product.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[e.quantity," \xd7 ",O(e.product.price)]}),(e.size||e.color)&&(0,r.jsxs)("div",{className:"flex gap-2 mt-1 items-center",children:[e.size&&(0,r.jsxs)(y.C,{variant:"secondary",className:"text-xs",children:["Размер: ",e.size]}),e.color&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"text-xs text-gray-500",children:"Цвет:"}),r.jsx("div",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:E.OA(e.color)?.value||"#CCCCCC",borderColor:"Белый"===e.color?"#E5E7EB":void 0},title:e.color})]})]})]}),r.jsx("div",{className:"text-right",children:r.jsx("p",{className:"font-medium",children:O(e.product.price*e.quantity)})})]},`${e._id}-${e.size||""}-${e.color||""}`))}),r.jsx(j.Z,{}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-700",children:"Товары"}),r.jsx("span",{className:"text-gray-900",children:O(a)})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-700",children:"Доставка"}),r.jsx("span",{className:"text-gray-900",children:0===F?"Бесплатно":O(F)})]}),F>0&&r.jsx("p",{className:"text-sm text-gray-500",children:"Бесплатная доставка при заказе от 5000 ₽"})]}),r.jsx(j.Z,{}),(0,r.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[r.jsx("span",{className:"text-gray-700",children:"Итого"}),r.jsx("span",{className:"text-gray-900",children:O($)})]})]})]})})]})]}),r.jsx(i.default,{})]})}},3478:(e,s,a)=>{"use strict";a.d(s,{_:()=>n});var r=a(80),t=a(9885),l=a(3618),c=a(7389),i=a(3161);let d=(0,c.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),n=t.forwardRef(({className:e,...s},a)=>r.jsx(l.f,{ref:a,className:(0,i.cn)(d(),e),...s}));n.displayName=l.f.displayName},501:(e,s,a)=>{"use strict";a.d(s,{Z:()=>i});var r=a(80),t=a(9885),l=a(2299),c=a(3161);let i=t.forwardRef(({className:e,orientation:s="horizontal",decorative:a=!0,...t},i)=>r.jsx(l.f,{ref:i,decorative:a,orientation:s,className:(0,c.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",e),...t}));i.displayName=l.f.displayName},1937:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$typeof:()=>c,__esModule:()=>l,default:()=>d});var r=a(7536);let t=(0,r.createProxy)(String.raw`/Users/mikhailkolotushin/KolTech/projects/dvb/client/app/checkout/page.tsx`),{__esModule:l,$$typeof:c}=t,i=t.default,d=i}};var s=require("../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),r=s.X(0,[6498,7001,7240,7962,2299,3089,5562,9807,1590,7052,4796,6037],()=>a(9582));module.exports=r})();